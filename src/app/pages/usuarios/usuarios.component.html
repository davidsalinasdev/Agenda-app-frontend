<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-body ">
        <div class="creacion animated fadeIn fast">
          <div class="titulos-tabla">
            <h4>Lista de usuarios</h4>
            <p>Sistema de contrataciones</p>
          </div>

          <!-- btn-crear-nuevos-usuarios -->
          <div class="btn-crear-usuario mb-2 mb-lg-0">
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal_crear_servidor"
              (click)="this.borrarFormulario(formDirective)"><i class="fa fa-user-plus"></i> Crear usuario</button>
          </div>
        </div>

        <!-- Buscar -->
        <div class="form-group">
          <label for="buscar">Buscar:</label>
          <input type="email" class="form-control example-full-width" id="buscar" placeholder="Ingrese su busqueda"
            [(ngModel)]="this.searchTerm" #texto (keyup)="searchTerm$.next(texto.value)">
        </div>

        <!-- Loading -->
        <div *ngIf="this.cargando" class="row animated fadeIn fast">
          <div class="col-12">
            <div class="alert alert-secondary text-center">
              <h4 class="alert-heading">Cargando</h4>
              <i class="fas fa-spin fa-refresh fa-2x"></i>
              <p class="mb-0">Por favor espere</p>
            </div>
          </div>
        </div>

        <!-- Tabla de datos -->
        <div *ngIf="!this.cargando" class="fadeIn fast table-shadow">
          <div class="table-responsive">
            <table class="table">
              <thead class="table-header">
                <tr class="table-header__encabezado">
                  <th style="width: 2%;">Codigo</th>
                  <th>Nombres</th>
                  <th>Ap. paterno</th>
                  <th>Ap. materno</th>
                  <th style="width: 110px;">Rol</th>
                  <th style="width: 120px;">Estado</th>
                  <th style="width: 150px;">Acciones</th>
                </tr>
              </thead>
              <tbody class="table-cuerpo">
                <tr
                  *ngFor="let item of this.dataServidores | paginate: { itemsPerPage: this.per_page, currentPage: this.p, totalItems:this.total, id: 'paginate_one' }"
                  class=" table-cuerpo__datos">
                  <td>{{ item.id }}</td>
                  <td>{{ item.nombres }}</td>
                  <td>{{ item.paterno }}</td>
                  <td>{{ item.materno }}</td>
                  <td>{{ item.rol }}</td>
                  <td>
                    <span *ngIf="item.estado === 'habilitado'; else notHabilitado"
                      class="p-1 bg-success text-white border rounded">{{item.estado}}</span>
                    <ng-template #notHabilitado>
                      <span class="p-1 bg-danger text-white border rounded">{{item.estado}}</span>
                    </ng-template>
                  </td>
                  <td>
                    <a class="text-warning btn-margen" (click)="this.modificarServidoresPublicos(item.id)">
                      <i class="fas fa-pen"></i>
                    </a>

                    <a class="ml-4 text-danger"
                      (click)="this.destroyServidorPublico(item.id,item.nombres,item.paterno,item.estado)">
                      <i class="fas fa-trash"></i>
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
            <!-- Paginación de datos -->
            <hr>
            <div class="paginacion d-flex flex-nowrap justify-content-end pr-3">
              <pagination-controls class="my-pagination" (pageChange)="this.pageChange($event)" previousLabel="Anterior"
                nextLabel="Siguiente" [maxSize]="this.per_page" id="paginate_one">
              </pagination-controls>
              <p class="pt-1 paginacion__cantitems">Items: {{ this.total }}</p>
            </div>
          </div>
        </div>
        <!-- FIN Tabla de datos -->

      </div>
    </div>
  </div>
</div>

<!-- Modal crear nuevos usuarios -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" style="display: none;"
  aria-hidden="true" id="myModal_crear_servidor">

  <form #formDirective="ngForm" [formGroup]="this.formulario" class="ps-4 pt-4 pe-4 pb-0" (ngSubmit)="submit()">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header bg-primary contenedor-header">
          <h5 class="modal-title text-white text-uppercase" id="myLargeModalLabel">Formulario de registro de
            usuarios</h5>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        </div>
        <div class="modal-body">

          <!-- Seccion 1 -->
          <div class="row mt-3">

            <!-- Nombres -->
            <div class="col-12 col-lg-4">
              <div class="form-group">
                <label for="nombres">Nombre completo</label>
                <input type="text" class="form-control" id="nombres" placeholder="Ingrese sus nombres"
                  formControlName="nombres">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.nombres?.invalid && (this.nombres?.dirty || this.nombres?.touched)" class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.nombres?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.nombres?.hasError('pattern')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta letras.
                  </div>
                  <div *ngIf="this.nombres?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 50 letras.
                  </div>
                </span>
              </div>
            </div>

            <!-- Paterno -->
            <div class="col-12 col-lg-4">

              <div class="form-group">
                <label for="paterno">Ap. paterno</label>
                <input type="text" class="form-control" id="paterno" placeholder="Ingrese su ap. paterno"
                  formControlName="paterno">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.paterno?.invalid && (this.paterno?.dirty || this.paterno?.touched)" class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.paterno?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.paterno?.hasError('pattern')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta letras.
                  </div>
                  <div *ngIf="this.paterno?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 50 letras.
                  </div>
                </span>
              </div>

            </div>

            <!-- Materno -->
            <div class="col-12 col-lg-4">

              <div class="form-group">
                <label for="materno">Ap. materno</label>
                <input type="text" class="form-control" id="materno" placeholder="Ingrese su ap. materno"
                  formControlName="materno">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.materno?.invalid && (this.materno?.dirty || this.materno?.touched)" class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.materno?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.materno?.hasError('pattern')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta letras.
                  </div>
                  <div *ngIf="this.materno?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 50 letras.
                  </div>
                </span>
              </div>

            </div>

          </div>
          <!-- Seccion 2 -->
          <div class="row">

            <!-- usuario -->
            <div class="col-12 col-lg-4">
              <div class="form-group">
                <label for="user">Usuario:</label>
                <input type="text" class="form-control" id="user" placeholder="Ingrese un usuario"
                  formControlName="user">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.user?.invalid && (this.user?.dirty || this.user?.touched)" class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.user?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.user?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 30 letras.
                  </div>
                </span>
              </div>
            </div>

            <!-- contraseña -->
            <div class="col-12 col-lg-4">
              <div class="form-group">
                <label for="password">Contraseña</label>
                <input type="text" class="form-control" id="password" placeholder="Ingrese nro. de carnet"
                  formControlName="password">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.password?.invalid && (this.password?.dirty || this.password?.touched)"
                  class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.password?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.password?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 30 letras.
                  </div>
                </span>
              </div>
            </div>

            <!-- Roles de usuario -->
            <div class="col-12 col-lg-4">
              <!-- Select rol -->
              <div class="form-group">
                <label for="inputRol">Seleccione un rol:</label>
                <select id="inputRol" class="form-control" formControlName="roluser">
                  <option *ngFor="let estado of this.roles" [value]="estado.value">
                    {{estado.roles}}
                  </option>
                </select>
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.roluser?.invalid && (this.roluser?.dirty || this.roluser?.touched)">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.roluser?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                </span>
              </div>

            </div>

          </div>

          <!-- <p class="text-left mt-3">Los campos con ( <span class="text-danger">*</span> ) son obligatorios</p> -->
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Cancelar</button>
          <div *ngIf="this.btnSave; else notBtnSave" class="">
            <button type="submit" class="ms-2 btn btn-primary waves-effect" [disabled]="this.formulario.invalid">
              Guardar
            </button>
          </div>

          <ng-template #notBtnSave>
            <button type="submit" class="ms-2 btn btn-primary waves-effect" [disabled]="this.notBtnSave">
              <span class="ms-2">Espere por favor</span>
            </button>
          </ng-template>
        </div>
      </div>
      <!-- /.modal-content -->
    </div>
  </form>
  <!-- /.modal-dialog -->
</div>
<!-- Fin Modal crear usuarios -->

<!-- Modal editar usuarios -->
<!-- sample modal content -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" style="display: none;"
  aria-hidden="true" id="myModal_editar_usuario">
  <form #formDirective="ngForm" [formGroup]="this.formularioModificar" class="ps-4 pt-4 pe-4 pb-0"
    (ngSubmit)="submitModificar()">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header bg-warning contenedor-header">
          <h5 class="modal-title text-white text-uppercase" id="myLargeModalLabel">Formulario de registro de
            usuarios</h5>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        </div>
        <div class="modal-body">

          <h4 class="mb-4">Modificar datos</h4>
          <!-- Seccion 1 -->
          <div class="row">

            <!-- Nombres -->
            <div class="col-12 col-lg-4">
              <div class="form-group">
                <label for="nombresM">Nombre completo</label>
                <input type="text" class="form-control" id="nombresM" placeholder="Ingrese nombre completo"
                  formControlName="nombresM">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.nombresM?.invalid && (this.nombresM?.dirty || this.nombresM?.touched)"
                  class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.nombresM?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.nombresM?.hasError('pattern')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta letras.
                  </div>
                  <div *ngIf="this.nombresM?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 50 letras.
                  </div>
                </span>
              </div>
            </div>

            <!-- Paterno -->
            <div class="col-12 col-lg-4">

              <div class="form-group">
                <label for="paternoM">Ap. paterno</label>
                <input type="text" class="form-control" id="paternoM" placeholder="Ingrese su ap. paterno"
                  formControlName="paternoM">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.paternoM?.invalid && (this.paternoM?.dirty || this.paternoM?.touched)"
                  class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.paternoM?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.paternoM?.hasError('pattern')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta letras.
                  </div>
                  <div *ngIf="this.paternoM?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 50 letras.
                  </div>
                </span>
              </div>

            </div>

            <!-- Materno -->
            <div class="col-12 col-lg-4">

              <div class="form-group">
                <label for="maternoM">Ap. materno</label>
                <input type="text" class="form-control" id="maternoM" placeholder="Ingrese su ap. materno"
                  formControlName="maternoM">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.maternoM?.invalid && (this.maternoM?.dirty || this.maternoM?.touched)"
                  class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.maternoM?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.maternoM?.hasError('pattern')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta letras.
                  </div>
                  <div *ngIf="this.maternoM?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 50 letras.
                  </div>
                </span>
              </div>

            </div>
          </div>
          <!-- Seccion 2 -->
          <div class="row">

            <!-- usuario -->
            <div class="col-12 col-lg-4">
              <div class="form-group">
                <label for="userM">Usuario:</label>
                <input type="text" class="form-control" id="userM" placeholder="Ingrese un usuario"
                  formControlName="userM">
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.userM?.invalid && (this.userM?.dirty || this.userM?.touched)" class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.userM?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                  <div *ngIf="this.userM?.hasError('maxlength')" class="animated fadeIn fast text-danger" id="">
                    Este campo solo acepta solo 30 letras.
                  </div>
                </span>
              </div>
            </div>


            <!-- Roles de usuario -->
            <div class="col-12 col-lg-4">
              <!-- Select rol -->
              <div class="form-group">
                <label for="inputRolM">Seleccione un rol:</label>
                <select id="inputRolM" class="form-control" formControlName="roluserM">
                  <option *ngFor="let estado of this.roles" [value]="estado.value">
                    {{estado.roles}}
                  </option>
                </select>
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.roluserM?.invalid && (this.roluserM?.dirty || this.roluserM?.touched)">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.roluserM?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                </span>
              </div>
            </div>

            <!-- Estado -->
            <div class="col-12 col-lg-4">
              <!-- Select estados -->
              <div class="form-group">
                <label for="inputState">Estado</label>
                <select id="inputState" class="form-control" formControlName="estadoM">
                  <option *ngFor="let estado of this.estados" [value]="estado.value">
                    {{estado.estado}}
                  </option>
                </select>
                <!-- Validacion -->
                <!-- Preguntamos si es invalido y si esta sucio o a sido tocado -->
                <span *ngIf="this.estadoM?.invalid && (this.estadoM?.dirty || this.estadoM?.touched)" class="texto-tam">
                  <!-- Errores con expresiones regulares -->
                  <div *ngIf="this.estadoM?.hasError('required')" class="animated fadeIn fast text-danger" id="">
                    Este campo es requerido.
                  </div>
                </span>
              </div>
            </div>

          </div>

          <p class="text-right mt-3">Los campos con ( <span class="text-danger">*</span> ) son obligatorios</p>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Cancelar</button>
          <div *ngIf="this.btnSave; else notBtnSave" class="">
            <button type="submit" class="ms-2 btn btn-primary waves-effect"
              [disabled]="this.formularioModificar.invalid">
              Guardar
            </button>
          </div>

          <ng-template #notBtnSave>
            <button type="submit" class="ms-2 btn btn-primary waves-effect" [disabled]="this.notBtnSave">
              <span class="ms-2">Espere por favor</span>
            </button>
          </ng-template>
        </div>
      </div>
      <!-- /.modal-content -->
    </div>
  </form>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
<!-- Fin modal editar usuarios -->
